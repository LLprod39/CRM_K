# Документация по функциональности ежедневных отчетов

## Обзор
Система ежедневных отчетов позволяет учителям заполнять отчеты о проведенном рабочем дне, отслеживать свою эффективность и предоставлять администрации полную информацию о проделанной работе.

## Функциональность

### Для обычных пользователей (учителей):

1. **Создание ежедневного отчета**
   - Автоматическое заполнение данных из системы (количество занятий, доходы)
   - Ручное заполнение суммы наличных денег
   - Добавление заметок о дне
   - Указание проблем и вопросов
   - Обратная связь от родителей/учеников

2. **Просмотр истории отчетов**
   - Список всех созданных отчетов
   - Детальная информация по каждому отчету
   - Статус проверки администратором
   - Комментарии администратора

3. **Статистика и аналитика**
   - Общая статистика по всем отчетам
   - Тренды доходности и эффективности
   - Анализ лучших и худших дней
   - Графики и диаграммы

### Для администраторов:

1. **Просмотр всех отчетов**
   - Отчеты всех учителей
   - Фильтрация по дате и пользователю
   - Отметка отчетов как проверенных
   - Добавление комментариев к отчетам

## Структура отчета

### Информация о занятиях:
- Запланировано занятий
- Проведено занятий
- Отменено занятий

### Финансовая информация:
- Заработано за день (автозаполнение)
- Получено платежей (автозаполнение)
- Наличные на руках (обязательно для заполнения)

### Дополнительная информация:
- Заметки о дне
- Проблемы и вопросы
- Обратная связь от родителей/учеников

## Автозаполнение данных

Система автоматически заполняет следующие поля на основе данных из расписания:
- Количество запланированных занятий
- Количество проведенных занятий
- Количество отмененных занятий
- Общая сумма заработанная за день
- Сумма полученных платежей

## Особенности использования

1. **Один отчет в день** - можно создать только один отчет на дату
2. **Обязательные поля** - наличные на руках должны быть указаны
3. **Автосохранение** - данные из системы подтягиваются автоматически
4. **Уведомления** - система уведомляет об успешном создании/обновлении отчетов

## Навигация

- Отчеты доступны через пункт меню "Отчеты" в сайдбаре
- На мобильных устройствах - через нижнюю навигацию
- Три основных вкладки:
  - **Новый отчет** - создание отчета за текущий день
  - **История** - просмотр всех отчетов
  - **Статистика** - аналитика и графики

## API Endpoints

### Основные endpoints:
- `GET /api/reports` - получение списка отчетов
- `POST /api/reports` - создание нового отчета
- `GET /api/reports/[id]` - получение конкретного отчета
- `PUT /api/reports/[id]` - обновление отчета
- `DELETE /api/reports/[id]` - удаление отчета
- `GET /api/reports/stats` - получение статистики для автозаполнения

### Права доступа:
- Обычные пользователи видят только свои отчеты
- Администраторы могут просматривать и комментировать все отчеты
- Только автор отчета может его удалить

## База данных

### Модель DailyReport:
```prisma
model DailyReport {
  id              Int      @id @default(autoincrement())
  date            DateTime // Дата отчета
  userId          Int      // ID пользователя
  
  // Информация о занятиях
  lessonsPlanned  Int      
  lessonsHeld     Int      
  lessonsCanceled Int      
  
  // Финансовая информация
  cashOnHand      Float    
  totalEarned     Float    
  paymentsReceived Float   
  
  // Дополнительная информация
  notes           String?  
  issues          String?  
  studentFeedback String?  
  
  // Административный контроль
  isReviewed      Boolean  @default(false)
  reviewNotes     String?  
  
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  user            User     @relation(fields: [userId], references: [id])
  
  @@unique([date, userId])
}
```

## Безопасность

- Все запросы требуют аутентификации через JWT токен
- Пользователи могут работать только со своими отчетами
- Админы имеют расширенные права доступа
- Валидация данных на стороне сервера

## Будущие улучшения

- Экспорт отчетов в Excel/PDF
- Настраиваемые уведомления
- Интеграция с календарем
- Мобильное приложение
- Автоматические напоминания о создании отчетов
