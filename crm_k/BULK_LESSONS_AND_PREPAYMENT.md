# Массовое создание занятий и система предоплаты

## Обзор

Добавлены новые функции для админа:
1. **Массовое создание занятий** - создание расписания на неделю/месяц
2. **Система предоплаты** - внесение предоплаты за период занятий

## Массовое создание занятий

### Функциональность
- Создание множества занятий по расписанию
- Поддержка индивидуальных и групповых занятий
- Настройка дней недели, времени и продолжительности
- Предварительный просмотр создаваемых занятий
- Проверка конфликтов времени

### Доступ
- Только для администраторов
- Кнопка "Массовое создание" в разделе "Занятия" админ панели

### Использование
1. Выберите учителя (обязательно для админов)
2. Выберите тип занятия (индивидуальное/групповое)
3. Выберите ученика(ов)
4. Укажите стоимость за занятие
5. Настройте период расписания (даты начала и окончания)
6. Выберите дни недели
7. Укажите время начала и продолжительность
8. Опционально: отметьте предоплату
9. Просмотрите предварительный список занятий
10. Создайте занятия

### API Endpoint
```
POST /api/lessons/bulk
```

## Система предоплаты

### Функциональность
- Внесение предоплаты за период занятий
- Автоматический расчет суммы на основе неоплаченных занятий
- Автоматическое обновление статуса занятий на "Предоплачено"
- Поддержка различных периодов (неделя, месяц, произвольный)

### Доступ
- Только для администраторов
- Кнопка "Предоплата" в разделе "Занятия" админ панели

### Использование
1. Выберите учителя (обязательно для админов)
2. Выберите ученика
3. Укажите период предоплаты
4. Система автоматически рассчитает сумму на основе неоплаченных занятий
5. При необходимости скорректируйте сумму
6. Укажите дату платежа и описание
7. Создайте предоплату

### API Endpoint
```
POST /api/payments/prepayment
```

## Логика статусов

Система использует существующую логику статусов:

- **Запланировано** → **Предоплачено** (при внесении предоплаты)
- **Предоплачено** → **Проведено** (при проведении урока)
- **Проведено** → **Оплачено** (доход)

## Технические детали

### Новые компоненты
- `BulkLessonForm.tsx` - форма массового создания занятий
- `PrepaymentForm.tsx` - форма создания предоплаты

### Новые API endpoints
- `/api/lessons/bulk` - массовое создание занятий
- `/api/payments/prepayment` - создание предоплаты

### Обновленные компоненты
- `LessonsManagement.tsx` - добавлены кнопки для новых функций
- `admin/page.tsx` - добавлена кнопка быстрого доступа

## Безопасность

- Все функции доступны только администраторам
- Проверка принадлежности учеников к выбранному учителю
- Валидация всех входных данных
- Проверка конфликтов времени при создании занятий

## Примеры использования

### Создание недельного расписания
1. Выберите учителя и ученика
2. Установите период: с понедельника по воскресенье
3. Выберите дни: понедельник, среда, пятница
4. Время: 10:00, продолжительность: 60 минут
5. Стоимость: 5000 тенге
6. Отметьте предоплату
7. Создайте 3 занятия с статусом "Предоплачено"

### Предоплата за месяц
1. Выберите учителя и ученика
2. Установите период: с 1 по 31 число текущего месяца
3. Система найдет все неоплаченные занятия в периоде
4. Автоматически рассчитает общую сумму
5. Создаст предоплату и обновит статус всех занятий
