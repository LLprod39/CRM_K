# Логика статусов занятий (обновлённая)

## Статусы занятий

- **Запланировано**
- **Предоплачено**
- **Отменено**
- **Оплачено**
- **Проведено**
- **Задолженность**
- **Не оплачено**

## Описание логики статусов

### 1. Запланировано

- **Авто** → попадает в календарь
- Если внесена предоплата → становится **Предоплачено** (Авто)

### 2. Отменено

- Если отмена за **5 часов и более** до начала → сумма уходит в предоплату ученика
- Если отмена **менее чем за 5 часов** до начала → сумма уходит в доход

### 3. Проведено

- Если проведено и оплачено → **Авто** → статус **Оплачено** + доход
- Если проведено, но не оплачено → статус **Задолженность** (ставит админ/пользователь)

### 4. Задолженность

- Когда урок проведён, но не оплачен
- Ставится вручную пользователем или админом

### 5. Не оплачено

- Если урок забронирован, но не оплачен
- Если урок проведён и не оплачен → **Авто** → переходит в **Задолженность**

## Схема переходов статусов

```
Запланировано → Предоплачено (при внесении предоплаты)
Запланировано → Отменено (при отмене урока)
Запланировано → Проведено (при проведении урока)
Проведено → Оплачено (при полной оплате)
Проведено → Задолженность (при отсутствии оплаты)
Не оплачено → Задолженность (автоматически после проведения)
```

## Правила отмены

- **Отмена за 5+ часов**: сумма → предоплата ученика
- **Отмена менее чем за 5 часов**: сумма → доход пользователя 
